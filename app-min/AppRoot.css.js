define(["require","exports"],function(a,b){b.styles='.c-AppRoot{padding:80px 20px;font-family:"Segoe UI","Segoe UI Symbol",HelveticaNeue-Light,"Helvetica Neue",Arial,sans-serif}.c-AppRoot .selectionDescription{padding:10px;border:1px solid #DDD;margin:20px 0}.c-AppRoot .controlArea{display:inline-block;width:400px}'});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define(["require","exports","AppRootBase","DatePicker","DomUtils","AppRoot.css"],function(a,b,c,d,e,f){e.loadStyles(f.styles);var g=function(a){function b(){a.apply(this,arguments),this.viewName="AppRoot",this.dp=this.addChild(new d),this._bindings=[{id:"0",text:"selection.selectedItem.month"},{id:"1",text:"selection.selectedItem.date"},{id:"2",text:"selection.selectedItem.year"}]}return __extends(b,a),b.prototype.onRenderElement=function(){var a=this,b=a._bindings;return a.element=a._ce("div",["class","c-AppRoot"],null,[a._ce("div",["class","selectionDescription"],null,[a._ct("\r\n            You have selected "),a._ce("span",[],b[0]),a._ct("-"),a._ce("span",[],b[1]),a._ct("-"),a._ce("span",[],b[2]),a._ct(".\r\n        ")]),a._ce("div",["class","controlArea"],null,[a.dp.renderElement()]),a._ce("div",["id","morePickers","class","controlArea"])])},b}(c);return g});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define(["require","exports","View"],function(a,b,c){var d=function(a){function b(){a.apply(this,arguments)}return __extends(b,a),b.prototype.onInitialize=function(){this.setData({selection:this.dp.selection})},b}(c);return d}),define(["require","exports"],function(){var a=function(){function a(a){this._timeoutIds=null,this._throttledFunctions=null,this._isDisposed=!1,this._parent=a||window}return a.prototype.dispose=function(){var a,b=this;if(b._isDisposed=!0,b._parent=null,b._timeoutIds){for(a in b._timeoutIds)b.clearTimeout(a);b._timeoutIds=null}b._throttledFunctions=null},a.prototype.setTimeout=function(a,b){var c=this,d=0;return c._isDisposed||(c._timeoutIds||(c._timeoutIds={}),d=setTimeout(function(){delete c._timeoutIds[d],a.apply(c._parent)},b),c._timeoutIds[d]=!0),d},a.prototype.clearTimeout=function(a){var b=this;b._timeoutIds&&b._timeoutIds[a]&&(clearTimeout(a),delete b._timeoutIds[a])},a.prototype.throttle=function(a,b,c,d,e){var f=this;if(!f._isDisposed){f._throttledFunctions||(f._throttledFunctions={});var g=f._throttledFunctions[a],h=(new Date).getTime();g?(g.lastExecuteTime=h,g.waitTime=b>g.waitTime?b:g.waitTime,g.maxWaitTime=c>g.maxWaitTime?c:g.maxWaitTime,g.callback=d,g.calledCallback=!1):(g=f._throttledFunctions[a]={lastExecuteTime:h,startTime:h,callback:d,waitTime:b,maxWaitTime:c,calledCallback:e},f.setTimeout(function(){f._callThrottledCallback(a)},b),e&&d())}},a.prototype._callThrottledCallback=function(a){var b=this;if(b._throttledFunctions){var c=b._throttledFunctions[a],d=(new Date).getTime(),e=d-c.startTime,f=d-c.lastExecuteTime;if(f>=c.waitTime||c.maxWaitTime&&e>=c.maxWaitTime)delete this._throttledFunctions[a],c.calledCallback||c.callback.apply(b._parent);else{var g=c.waitTime-f;c.maxWaitTime&&(g=Math.max(0,Math.min(g,c.maxWaitTime-e))),b.setTimeout(function(){b._callThrottledCallback(a)},g)}}},a}();return a}),define(["require","exports"],function(a,b){b.styles=".dp-control{border:1px solid #DDD;border-radius:4px;padding:10px}.dp-month-header{white-space:nowrap;padding-bottom:20px;text-align:center}.dp-month-prev{padding:0 5px;float:left}.dp-month-title{display:inline-block;text-align:center;padding:0 20px;font-size:150%}.dp-month-next{padding:0 5px;float:right}.dp-calendar{width:100%}.dp-day-header{font-weight:700}.dp-day-cell{padding:10px;border:1px solid #fff;color:#BBB}.dp-day-cell:hover{cursor:pointer;background:#EFEFEF}.dp-day-cell.isSelected{border:2px dashed #000;padding:8px}.dp-day-cell.isInMonth{color:#000}.dp-day-cell.isToday{background:#CBECFF}.dp-day-cell,.dp-day-header{text-align:center}"});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define(["require","exports","DatePickerModel","View","DatePickerBase","Repeater","DomUtils","DatePicker.css"],function(a,b,c,d,e,f,g,h){g.loadStyles(h.styles);var i=function(a){function b(){a.apply(this,arguments),this.viewName="DatePickerBlock0Item",this._bindings=[{id:"0",text:"day"}]}return __extends(b,a),b.prototype.onRenderElement=function(){var a=this,b=a._bindings;return a.element=a._ce("td",["class","dp-day-header"],b[0])},b}(d),j=function(a){function b(){a.apply(this,arguments),this.viewName="DatePickerBlock0",this.childViewType=i,this.itemName="day",this._bindings=[{id:"0",childId:"surface"}]}return __extends(b,a),b.prototype.onRenderElement=function(){var a=this,b=a._bindings;return a.element=a._ce("tr",["class","dp-week-header"],b[0],this.getChildElements())},b}(f),k=function(a){function b(){a.apply(this,arguments),this.viewName="DatePickerBlock2Item",this._bindings=[{id:"0",text:"day.date",className:{isInMonth:"day.isInMonth",isToday:"day.isToday",isSelected:"day.isSelected"},events:{click:["$view._onClick(day)"]}}]}return __extends(b,a),b.prototype.onRenderElement=function(){var a=this,b=a._bindings;return a.element=a._ce("td",["class","dp-day-cell"],b[0])},b}(d),l=function(a){function b(){a.apply(this,arguments),this.viewName="DatePickerBlock2",this.childViewType=k,this.itemName="day",this._bindings=[{id:"0",childId:"surface"}]}return __extends(b,a),b.prototype.onRenderElement=function(){var a=this,b=a._bindings;return a.element=a._ce("tr",[],b[0],this.getChildElements())},b}(f),m=function(a){function b(){a.apply(this,arguments),this.viewName="DatePickerBlock1Item",this.datePickerBlock2=this.addChild(new l)}return __extends(b,a),b.prototype.onInitialize=function(){a.prototype.onInitialize.call(this),this.datePickerBlock2.owner=this.owner},b.prototype.onViewModelChanged=function(){a.prototype.onViewModelChanged.call(this),this.datePickerBlock2.setData({items:this.getValue("week")})},b.prototype.onRenderElement=function(){{var a=this;a._bindings}return a.element=a.datePickerBlock2.renderElement()},b}(d),n=function(a){function b(){a.apply(this,arguments),this.viewName="DatePickerBlock1",this.childViewType=m,this.itemName="week",this._bindings=[{id:"0",childId:"surface"}]}return __extends(b,a),b.prototype.onRenderElement=function(){var a=this,b=a._bindings;return a.element=a._ce("tbody",[],b[0],this.getChildElements())},b}(f),o=function(a){function b(){a.apply(this,arguments),this.viewName="DatePicker",this.viewModelType=c,this.datePickerBlock0=this.addChild(new j),this.datePickerBlock1=this.addChild(new n),this._bindings=[{id:"0",events:{keydown:["$view._onKeyDown"]}},{id:"1",events:{click:["$view.adjustMonth"]}},{id:"2",events:{click:["$view.adjustMonth('next')"]}},{id:"3",text:"$view.titleText"}]}return __extends(b,a),b.prototype.onInitialize=function(){a.prototype.onInitialize.call(this),this.datePickerBlock0.owner=this,this.datePickerBlock1.owner=this},b.prototype.onViewModelChanged=function(){a.prototype.onViewModelChanged.call(this),this.datePickerBlock0.setData({items:this.getValue("$view._days")}),this.datePickerBlock1.setData({items:this.getValue("$view.weeks")})},b.prototype.onRenderElement=function(){var a=this,b=a._bindings;return a.element=a._ce("div",["class","dp-control","tabindex","0"],b[0],[a._ce("div",["class","dp-month-header"],null,[a._ce("a",["href","#","class","dp-month-prev"],b[1],[a._ct("Prev")]),a._ce("a",["href","#","class","dp-month-next"],b[2],[a._ct("Next")]),a._ce("div",["class","dp-month-title"],b[3])]),a._ce("table",["class","dp-calendar","cellpadding","0","cellspacing","0"],null,[a._ce("thead",[],null,[a.datePickerBlock0.renderElement()]),a.datePickerBlock1.renderElement()])])},b}(e);return o});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define(["require","exports","View","DatePickerStrings","Selection","ViewModel"],function(a,b,c,d,e,f){var g=function(a){function b(){a.apply(this,arguments),this.weeks=[],this.selection=new e,this._dateToItem={},this._selectedMonth=-1,this._months=d.months,this._days=d.days}return __extends(b,a),b.prototype.adjustMonth=function(a){var b="next"==a?1:-1,c=this.getViewModel(),d=new Date(c.year,c.month+b,1);return c.setData({year:d.getFullYear(),month:d.getMonth()}),!1},b.prototype.onViewModelChanged=function(){var a=this.getViewModel();this._selectedMonth!==a.month&&(this._selectedMonth=a.month,this.titleText=d.titleFormat.replace("{month}",this._months[a.month]).replace("{year}",a.year),this.weeks=this._getWeeks(a.month,a.year),this._dateToItem=this._getDateToItem(this.weeks)),this.selection.setSelected(this._dateToItem[new Date(a.year,a.month,a.date).getTime()])},b.prototype._getWeeks=function(a,b){for(var c=new Date(b,a,1),d=((new Date).getTime(),[]);c.getDay()>0;)c.setDate(c.getDate()-1);for(var e=0;6>e;e++){for(var g=[],h=0;6>=h;h++)g.push(new f({key:c.getTime(),date:c.getDate(),month:c.getMonth()+1,year:c.getFullYear(),isInMonth:c.getMonth()===a,isToday:this._isToday(c),weekIndex:e,dayIndex:h,originalDate:new Date(c.toString()),selection:this.selection,isSelected:function(){return this.selection.isSelected(this)}})),c.setDate(c.getDate()+1);d.push(g)}return d},b.prototype._getDateToItem=function(a){for(var b={},c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.length;e++){var f=d[e];b[f.originalDate.getTime()]=f}return b},b.prototype._isToday=function(a){var b=new Date;return a.getFullYear()==b.getFullYear()&&a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()},b.prototype._onClick=function(a){return this._updateByDate(a.originalDate),!1},b.prototype._onKeyDown=function(a){{var b=this.selection.getSelectedItems()[0],c=new Date(b.originalDate.toString()),d=c.getDate();this.getViewModel()}switch(a.which){case 37:c.setDate(d-1);break;case 39:c.setDate(d+1);break;case 38:c.setDate(d-7);break;case 40:c.setDate(d+7);break;default:return}return this._updateByDate(c),!1},b.prototype._updateByDate=function(a){this.setData({year:a.getFullYear(),month:a.getMonth(),date:a.getDate()})},b}(c);return g});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define(["require","exports","ViewModel"],function(a,b,c){var d=function(a){function b(){a.apply(this,arguments),this.month=(new Date).getMonth(),this.year=(new Date).getFullYear(),this.date=1}return __extends(b,a),b}(c);return d}),define(["require","exports"],function(){var a={titleFormat:"{month} {year}",months:["January","February","March","April","May","June","July","August","September","October","November","December"],days:["Su","Mo","Tu","We","Th","Fr","Sa"]};return a}),define(["require","exports"],function(){var a,b=function(){function b(){}return b.toggleClass=function(a,b,c){var d=a._classes=a._classes||(a.className?a.className.split(" "):[]),e=d.indexOf(b);c?-1==e&&d.push(b):e>-1&&d.splice(e,1),a.className=d.join(" ")},b.loadStyles=function(a){var b=document.createElement("style");b.type="text/css",b.appendChild(document.createTextNode(a)),document.head.appendChild(b)},b.setText=function(b,c){if(!document.body)throw"setText can't be called before body is available.";void 0===a&&(a=document.body.hasOwnProperty("textContent")?"textContent":"innerText"),b[a]=c},b}();return b}),define(["require","exports"],function(){var a=function(){function a(){}return a.toHtml=function(b){return String(a.toSafe(b)).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},a.toHtmlAttr=function(b){return a.toHtml(b)},a.toJS=function(a){return a||""},a.toUrl=function(b){return a.toSafe(b)},a.toSafe=function(a){return a||""},a}();return a}),define(["require","exports"],function(){var a=function(){function a(b){this._id=a._uniqueId++,this._parent=b||window,this._eventRecords=[]}return a.prototype.dispose=function(){this.off(),this._parent=null},a.prototype.on=function(a,b,c){function d(){var a=c.apply(g,arguments);return a===!1&&arguments[0]&&arguments[0].preventDefault&&arguments[0].preventDefault(),a}if(b.indexOf(",")>-1)for(var e=b.split(/[ ,]+/),f=0;f<e.length;f++)this.on(a,e[f],c);else{var g=this._parent,h={target:a,eventName:b,parent:g,callback:c,elementCallback:null};a.__events=a.__events||{},a.__events[b]=a.__events[b]||{count:0},a.__events[b][this._id]=a.__events[b][this._id]||[],a.__events[b][this._id].push(h),a.__events[b].count++,a.addEventListener&&(h.elementCallback=d,a.addEventListener(b,d),"click"===b&&a.addEventListener("touchstart",d)),this._eventRecords.push(h)}},a.prototype.off=function(a,b,c){for(var d=0;d<this._eventRecords.length;d++){var e=this._eventRecords[d];if(!(a&&a!==e.target||b&&b!==e.eventName||c&&c!==e.callback)){var f=e.target.__events[e.eventName],g=f[this._id];1!==g.length&&c?g.splice(g.indexOf(e),1):delete e.target.__events[e.eventName][this._id],--f.count||delete e.target.__events[e.eventName],e.target.removeEventListener&&(e.target.removeEventListener(e.eventName,e.elementCallback),"click"===b&&a.removeEventListener("touchstart",e.elementCallback)),this._eventRecords.splice(d,1)}}},a.prototype.raise=function(a,b,c){for(var d,e=this._parent;e&&d!==!1;){var f=e.__events?e.__events[a]:null;for(var g in f)for(var h=f[g],i=0;d!==!1&&i<h.length;i++){var j=h[i];d=j.callback.call(j.parent,b)}e=c?e.parent:null}return d},a.prototype.declare=function(a){var b=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof a)b[a]=!0;else for(var c=0;c<a.length;c++)b[a[c]]=!0},a.prototype.autoWire=function(b,c){b=b||this._parent,c="on"+(c||"");var d=this._parent.constructor.prototype;for(var e in d)if("function"==typeof d[e]&&0===e.indexOf(c)){var f=e.substr(c.length,1).toLowerCase()+e.substr(c.length+1);a.isDeclared(b,f)&&this.on(this._parent,f,this._parent[e])}},a.isObserved=function(a,b){return a&&a.__events&&a.__events[b]},a.isDeclared=function(a,b){return a&&a.__declaredEvents&&a.__declaredEvents[b]},a._uniqueId=0,a}();return a}),define(["require","exports"],function(){}),define(["require","exports"],function(){}),define(["require","exports","EventGroup"],function(a,b,c){var d="change",e="change",f=function(){function a(a){this.isList=!0,this.events=new c(this),this.array=a||[],this.events.declare([d,e])}return a.prototype.clear=function(){this.array=[],this.events.off()},a.prototype.getCount=function(){return this.array.length},a.prototype.setCount=function(a){this.array.length=a},a.prototype.indexOf=function(a){return this.array.indexOf(a)},a.prototype.getAt=function(a){return this.array[a]},a.prototype.setAt=function(a,b){this.array[a]&&this.events.off(this.array[a]),this.array[a]=b,b&&c.isDeclared(b,d)&&this.events.on(b,d,this.childChange),this.change({type:"update",index:a,item:b})},a.prototype.setRange=function(a,b){for(var c=0;c<b.length;c++)this.setAt(a++,b[c]);this.change({type:"insertRange",index:a,items:b})},a.prototype.insertAt=function(a,b){this.array.splice(a,0,b),b&&c.isDeclared(b,d)&&this.events.on(b,d,this.childChange),this.change({type:"insert",index:a,item:b})},a.prototype.push=function(a){return this.setAt(this.array.length,a),this.change({type:"insert",index:this.array.length-1,item:a}),a},a.prototype.pop=function(){var a=this.array.pop();return this.change({type:"remove",index:this.array.length}),a},a.prototype.remove=function(a){this.removeAt(this.array.indexOf(a))},a.prototype.removeAt=function(a){if(a>=0&&a<this.array.length){var b=this.array[a];b&&this.events.off(this.array[a]),this.array.splice(a,1),this.change({type:"remove",index:a})}},a.prototype.change=function(a){this.events.raise(d,a)},a.prototype.childChange=function(){this.events.raise(e)},a}();return f});var __extends=this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);c.prototype=b.prototype,a.prototype=new c};define(["require","exports","View","List"],function(a,b,c,d){var e=function(a){function b(){a.apply(this,arguments),this.viewName="Repeater",this.collectionName="items",this.itemName="item",this.indexName="index",this.childViewType=c,this.baseClass="",this.currentList=new d,this._surfaceRoots=[],this._bindings=[{id:"0",childId:"surface"}]}return __extends(b,a),b.prototype.onRenderElement=function(){return this.element=this._ce("div",["class",this.baseClass],null,this.getChildElements())},b.prototype.getChildElements=function(){var a=this.getValue(this.collectionName),b=[];a&&a.isList||(a=new d(a)),this.clearChildren();for(var c=0;a&&c<a.getCount();c++)b.push(this._createChild(a.getAt(c),c).renderElement());return b},b.prototype.onViewModelChanged=function(a){if(2===this._state){var b=this.element,c=a?a.type:"reset";switch(c){case"insert":var d=(document.createElement("div"),document.createDocumentFragment(),this._createChild(a.item,a.index)),e=b.childNodes[a.index],f=d.renderElement();e?b.insertBefore(f,e):b.appendChild(f),d.activate();break;case"remove":var g=b.childNodes[a.index],h=g.control;h.dispose(),this.removeChild(h),b.removeChild(g);break;default:this._diffChildren()}}},b.prototype._diffChildren=function(){for(var a,b,c=new d(this.getValue(this.collectionName)),e=this.element,f=0;c&&f<c.getCount();f++){var g=c.getAt(f);a=e.childNodes[f],b=a?a.control:null,b?this._updateChildData(b,g,f):(b=this._createChild(g,f),e.appendChild(b.renderElement()),b.activate())}for(;e.childNodes.length>(c?c.getCount():0);)a=e.childNodes[e.childNodes.length-1],b=a.control,b.dispose(),this.removeChild(b),e.removeChild(a)},b.prototype._createChild=function(a,b){var c=this.addChild(new this.childViewType,this.owner);return this._updateChildData(c,a,b),c},b.prototype._updateChildData=function(a,b,c){var d;d={},d[this.itemName]=b,d[this.indexName]=c,a.setData(d)},b}(c);return e}),define(["require","exports","EventGroup"],function(a,b,c){var d=function(){function a(){this.selectedItem=null,this._selectedItems={},this._singleSelect=!0,this._events=new c(this),this._events.declare("change")}return a.prototype.clear=function(){this._selectedItems={}},a.prototype.getSelectedItems=function(){var a=[];for(var b in this._selectedItems)a.push(this._selectedItems[b]);return a},a.prototype.setSelected=function(a,b){var c=a.key;if(b=b===!1?!1:!0,!c)throw"Items used with Selection must have keys.";this._singleSelect&&this.clear(),b?this.selectedItem=this._selectedItems[c]=a:delete this._selectedItems[c],this._events.raise("change")},a.prototype.isSelected=function(a){return!!this._selectedItems[a.key]},a}();return d}),define(["require","exports","ViewModel","EventGroup","DomUtils"],function(a,b,c,d,e){var f;!function(a){a[a.CREATED=0]="CREATED",a[a.INACTIVE=1]="INACTIVE",a[a.ACTIVE=2]="ACTIVE",a[a.DISPOSED=3]="DISPOSED"}(f||(f={}));var g=function(){function a(a){this.viewName="View",this.viewModelType=c,this.subElements={},this._bindings=[],this._lastValues={},this._state=0,this.events=new d(this),this.activeEvents=new d(this),this.children=[],this._inheritedModel=a}return a.prototype.dispose=function(){for(var a=0;a<this.children.length;a++)this.children[a].dispose();3!==this._state&&(2==this._state&&this.deactivate(),this._state=3,this.clearChildren(),this.events.dispose(),this.activeEvents.dispose(),this._inheritedModel||this._viewModel.dispose(),this.element&&(this.element.control=null,this.element=null),this.subElements=null)},a.prototype.onInitialize=function(){},a.prototype.onRenderElement=function(){this.element=this._ce("div")},a.prototype.onResize=function(){},a.prototype.onActivate=function(){},a.prototype.onDeactivate=function(){},a.prototype.onViewModelChanged=function(){},a.prototype.setData=function(a,b){3!==this._state&&(this.initialize(),this._viewModel.setData(a,b))},a.prototype.initialize=function(){if(0===this._state){this._state=1,this.id=this.viewName+"-"+a._instanceCount++,this._viewModel=this._inheritedModel?this._inheritedModel:new this.viewModelType,this.events.on(this._viewModel,"change",this.evaluateView),this._viewModel.initialize(),this.onViewModelChanged(),this.onInitialize();for(var b=0;b<this.children.length;b++)this.children[b].initialize()}},a.prototype.renderElement=function(){return 3!==this._state&&(this.initialize(),this.onRenderElement(),this.updateView(),this.element.control=this),this.element},a.prototype.activate=function(){for(var a=0;a<this.children.length;a++)this.children[a].activate();1===this._state&&(this._state=2,this._bindEvents(),this.onActivate())},a.prototype.deactivate=function(){for(var a=0;a<this.children.length;a++)this.children[a].deactivate();2===this._state&&(this._state=1,this.onDeactivate(),this.activeEvents.off())},a.prototype.resize=function(){if(2===this._state){this.onResize();for(var a=0;a<this.children.length;a++)this.children[a].resize()}},a.prototype.addChild=function(a,b){return a.parent=this,a.owner=b,this.children.push(a),a},a.prototype.removeChild=function(a){{var b=this.children.indexOf(a);this.children[b]}return b>-1&&(this.children.splice(b,1)[0].parent=null),a},a.prototype.clearChildren=function(){for(;this.children.length>0;)this.removeChild(this.children[0])},a.prototype.evaluateView=function(a){this.onViewModelChanged(a),this.updateView()},a.prototype.updateView=function(a){if(this._bindings&&this.element)for(var b=0;this._bindings&&b<this._bindings.length;b++){var c=this._bindings[b];for(var d in c)if("id"!=d&&"events"!=d&&"childId"!=d&&"element"!=d)if("text"===d||"html"===d)this._updateViewValue(c,d,c[d],a);else for(var e in c[d])this._updateViewValue(c,d,c[d][e],a,e)}},a.prototype._updateViewValue=function(a,b,c,d,f){var g=a.id+b+(f?"."+f:""),h=this._lastValues[g],i=this.getValue(c);if(h!=i&&(this._lastValues[g]=i,!d)){var j=this.subElements[a.id];switch(console.log('Updating "'+a.id+'" because "'+c+'" changed to "'+i+'"'),b){case"text":j.textContent=i;break;case"html":j.innerHTML=i;break;case"css":j.style[f]=i;break;case"className":e.toggleClass(j,f,i);break;case"attr":"value"===f||"checked"===f?j[f]=i:i?j.setAttribute(f,i):j.removeAttribute(f)}}},a.prototype.getViewModel=function(){return this._viewModel},a.prototype.getValue=function(a){var b=this._getPropTarget(a),c=b&&b.target?b.target[b.propertyName]:"";return"function"==typeof c&&(c=c.call(b.target,this._viewModel,b.propertyName)),c},a.prototype.setValue=function(a,b){var c=this._getPropTarget(a),d=c.viewModel;d&&"function"!=typeof c.target[c.propertyName]&&(c.target[c.propertyName]=b,d.change())},a.prototype._getPropTarget=function(a){for(var b,c=this,d=c.getViewModel(),e=d,f=a.indexOf(".");f>-1&&e;)b=a.substr(0,f),"$debug"===b||("$parent"===b?(c=this.parent.owner||this.parent,e=c?c.getViewModel():null):"$root"===b?(c=this._getRoot(),e=c.getViewModel()):"$view"===b?(c=this.owner||this,e=c,d=null):e=e[b]),e&&e.isViewModel&&(d=e),a=a.substr(f+1),f=a.indexOf(".");return{originView:this,view:c,viewModel:d,target:e,propertyName:a}},a.prototype._getRoot=function(){for(var a=this;a.parent;)a=a.parent;return a},a.prototype._ce=function(a,b,c,d){var e,f,g=document.createElement(a);for(e=0;b&&e<b.length;e+=2)g.setAttribute(b[e],b[e+1]);if(c){this.subElements[c.id]=c.element=g,c.childId&&(this.subElements[c.childId]=g);for(var h in c.attr)f=this.getValue(c.attr[h]),f&&g.setAttribute(h,f)}if(d)for(e=0;e<d.length;e++)g.appendChild(d[e]);return g},a.prototype._ct=function(a){return document.createTextNode(a)},a.prototype._bindEvents=function(){for(var a=0;a<this._bindings.length;a++){var b=this._bindings[a],c=b.element;for(var d in b)if("id"!=d&&"events"!=d&&"element"!=d)for(var e in b[d]){var f=b[d][e];f.indexOf("$parent")>-1&&this._viewModel.setData({$parent:(this.owner||this.parent).getViewModel()},!1),f.indexOf("$root")>-1&&this._viewModel.setData({$root:this._getRoot().getViewModel()},!1)}if(b.events)for(var g in b.events){var h=b.events[g];this._bindEvent(c,g,h)}this._bindInputEvent(c,b)}},a.prototype._bindInputEvent=function(a,b){b.attr&&(b.attr.value||b.attr.checked)&&this.activeEvents.on(a,"input,change",function(){var c=b.attr.value?"value":"checked",d=a[c],e=b.id+"attr."+c;return this._lastValues[e]=d,this.setValue(b.attr[c],d),!1})},a.prototype._bindEvent=function(a,b,c){var d=this;this.activeEvents.on(a,b,function(){for(var a=0;a<c.length;a++){var b=c[a],e=arguments,f=b.indexOf("(");if(f>-1){var g=b.substr(f+1,b.length-f-2).split(/[\s,]+/);e=[];for(var h=0;h<g.length;h++){var i=g[h];e.push("'"==i[0]?i.substr(1,i.length-2):this.getValue(g[h]))}b=b.substr(0,f)}var j=d._getPropTarget(b),k=j.target,l=j.propertyName;if(k&&k[l])return k[l].apply(k,e)}})},a.prototype.toggle=function(a){return this.setValue(a,!this.getValue(a)),!1},a.prototype.send=function(a,b){this.setValue(b,this.getValue(a))},a._instanceCount=0,a}();return g}),define(["require","exports","EventGroup"],function(a,b,c){var d=function(){function a(b){this.isViewModel=!0,this.__id=a.__instanceCount++,this.__events=new c(this),this.__events.declare("change"),this.setData(b)}return a.prototype.initialize=function(){this.setData(this,!1,!0),this.onInitialize()},a.prototype.onInitialize=function(){},a.prototype.dispose=function(){this.__events.dispose(),this.onDispose()},a.prototype.onDispose=function(){},a.prototype.setData=function(a,b,d){var e=!1;for(var f in a)if(a.hasOwnProperty(f)&&0!==f.indexOf("__")&&"setData"!==f&&"dispose"!==f&&"change"!==f){var g=this[f],h=a[f];(g!==h||d)&&(g&&c.isDeclared(g,"change")&&this.__events.off(g),this[f]=h,e=!0,h&&c.isDeclared(h,"change")&&this.__events.on(h,"change",this.change))}(e&&b!==!1||b===!0)&&this.__events.raise("change")},a.prototype.change=function(a){this.__events.raise("change",a)},a.__instanceCount=0,a}();return d}),define(["require","exports","AppRoot"],function(a,b,c){function d(){var a=new c,b=document.body;window.addEventListener("unload",function(){a.dispose()}),window.addEventListener("resize",function(){a.resize()}),b.appendChild(a.renderElement()),a.activate()}document.body?d():document.onload=d});